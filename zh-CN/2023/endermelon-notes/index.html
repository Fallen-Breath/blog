<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.loli.net/css?family=Courgette:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.fallenbreath.me","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":{"enable":false,"onlypost":true},"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="末影人西瓜农场笔记 注意！这篇文章仍处于施工中，具体完工时间未知">
<meta property="og:type" content="article">
<meta property="og:title" content="末影人西瓜农场笔记">
<meta property="og:url" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/index.html">
<meta property="og:site_name" content="fallen&#39;s attic">
<meta property="og:description" content="末影人西瓜农场笔记 注意！这篇文章仍处于施工中，具体完工时间未知">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/coord.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/eyepos.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/enderman-teleport.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/pickup-target.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/pick.gif">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/edgecase.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/raycast-corner.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/edgecase-explaination.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/placedown-target.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/placedown-underneath.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/placement-proof.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/followRange-distribution.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/crop-grow-speed.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/crop-grow-speed-example.png">
<meta property="og:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/farm-architecture.png">
<meta property="article:published_time" content="2023-01-07T17:23:59.000Z">
<meta property="article:modified_time" content="2023-01-10T17:39:32.000Z">
<meta property="article:author" content="Fallen_Breath">
<meta property="article:tag" content="Minecraft">
<meta property="article:tag" content="末影人">
<meta property="article:tag" content="刷怪">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/coord.png">


<link rel="canonical" href="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/","path":"zh-CN/2023/endermelon-notes/","title":"末影人西瓜农场笔记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>末影人西瓜农场笔记 | fallen's attic</title>
  






  <script async defer data-website-id="35f37ce2-b390-4892-baf1-abf29a3bf02d" src="https://umami.fallenbreath.me/script.js"></script>


  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">fallen's attic</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9C%AB%E5%BD%B1%E4%BA%BA%E8%A5%BF%E7%93%9C%E5%86%9C%E5%9C%BA%E7%AC%94%E8%AE%B0"><span class="nav-text">末影人西瓜农场笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E8%A8%80"><span class="nav-text">引言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E6%9C%AF%E8%AF%AD"><span class="nav-text">一些术语</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9D%90%E6%A0%87"><span class="nav-text">坐标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AI"><span class="nav-text">AI</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%90%86%E8%AE%BA%E7%9F%A5%E8%AF%86"><span class="nav-text">理论知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AB%E5%BD%B1%E4%BA%BA"><span class="nav-text">末影人</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9E%AC%E7%A7%BB"><span class="nav-text">瞬移</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8D%A1%E8%B5%B7%E6%96%B9%E5%9D%97"><span class="nav-text">捡起方块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%94%BE%E7%BD%AE%E6%96%B9%E5%9D%97"><span class="nav-text">放置方块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%87%E6%81%A8"><span class="nav-text">仇恨</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E7%89%A9-AI"><span class="nav-text">生物 AI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%93%9C%E8%8B%97"><span class="nav-text">瓜苗</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%91%B1%E5%94%A7%E5%88%86%E6%9E%90"><span class="nav-text">呱唧分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%9C%E5%9C%BA%E7%BB%93%E6%9E%84"><span class="nav-text">农场结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E6%8F%90%E5%81%87%E8%AE%BE"><span class="nav-text">前提假设</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%90%86%E8%AE%BA%E6%95%88%E7%8E%87%E8%AE%A1%E7%AE%97"><span class="nav-text">理论效率计算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%93%9C%E5%AF%86%E5%BA%A6"><span class="nav-text">瓜密度</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%B2%E7%AA%81%E7%93%9C"><span class="nav-text">冲突瓜</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="nav-text">设计思路</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E6%9C%AB%E5%BD%B1%E8%9E%A8%E4%BB%87%E6%81%A8%E7%9A%84%E7%93%9C%E6%9C%BA"><span class="nav-text">基于末影螨仇恨的瓜机</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%B7%E6%80%AA%E5%8D%95%E5%85%83"><span class="nav-text">刷怪单元</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8D%A1%E7%93%9C%E9%80%9A%E9%81%93"><span class="nav-text">捡瓜通道</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%84%E6%AD%BB%E6%A8%A1%E5%9D%97"><span class="nav-text">处死模块</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E6%9C%BA%E6%A2%B0%E7%BB%93%E6%9E%84%E7%9A%84%E7%93%9C%E6%9C%BA"><span class="nav-text">基于机械结构的瓜机</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%B7%E6%80%AA%E5%8D%95%E5%85%83-2"><span class="nav-text">刷怪单元</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8D%A1%E7%93%9C%E9%80%9A%E9%81%93-2"><span class="nav-text">捡瓜通道</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%84%E6%AD%BB%E6%A8%A1%E5%9D%97-2"><span class="nav-text">处死模块</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-text">参考</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Fallen_Breath"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Fallen_Breath</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://fallenbreath.me/" title="HomePage → https:&#x2F;&#x2F;fallenbreath.me&#x2F;" rel="noopener me" target="_blank"><i class="fa fa-house fa-fw"></i>HomePage</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/Fallen-Breath" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Fallen-Breath" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/4690315" title="Bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;4690315" rel="noopener me" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://www.youtube.com/c/FallenBreath" title="YouTube → http:&#x2F;&#x2F;www.youtube.com&#x2F;c&#x2F;FallenBreath" rel="noopener me" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://xiaoyuan-xyz.github.io/" title="https:&#x2F;&#x2F;xiaoyuan-xyz.github.io&#x2F;" rel="noopener" target="_blank">小渊的博客</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://lucunji.github.io/" title="https:&#x2F;&#x2F;lucunji.github.io&#x2F;" rel="noopener" target="_blank">LucunJi</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div><script src="/js/canvas-nest.js"></script>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Fallen_Breath">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fallen's attic">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="末影人西瓜农场笔记 | fallen's attic">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          末影人西瓜农场笔记
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-01-08 01:23:59" itemprop="dateCreated datePublished" datetime="2023-01-08T01:23:59+08:00">2023-01-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-01-11 01:39:32" itemprop="dateModified" datetime="2023-01-11T01:39:32+08:00">2023-01-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Minecraft/" itemprop="url" rel="index"><span itemprop="name">Minecraft</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>10k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>19 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="末影人西瓜农场笔记"><a class="header-anchor" href="#末影人西瓜农场笔记"></a>末影人西瓜农场笔记</h1>
<p>注意！这篇文章仍处于<strong>施工中</strong>，具体完工时间未知</p>
<span id="more"></span>
<h2 id="引言"><a class="header-anchor" href="#引言"></a>引言</h2>
<p>末影人西瓜农场，指的是一类利用末影人死亡时必定掉落其手持方块物品形式的机制，让末影人捡起西瓜方块，随后杀死末影人的一种农场。本文将“小黑”这一末影人的俗称指代末影人，使用“小黑瓜机”或“瓜机”（无歧义时）指代末影人西瓜农场。</p>
<p>直接用活塞推动西瓜方块，只能掉落西瓜片，如果需要获得西瓜块的话，玩家还需要手动合成西瓜。作为唯一能全自动获得西瓜方块的方式，小黑瓜机可以避免传统推瓜农场在后续合成瓜块方面的工作量，能让西瓜的生产实现全自动。</p>
<p>小黑瓜机的产率在众多作物农场间并不出色。与普通作物农场相比，由于小黑瓜机涉及到了自然刷怪，因此无法简单地通过堆叠模块增加面积的方式提升效率；与普通刷怪塔相比，由于小黑在刷出后不能直接处死，而是需要放进瓜田里尝试捡一会瓜才能处死，这显著地增加了小黑存活时间，导致小黑瓜机无法像普通刷怪塔一样有着动辄几十万的产率。</p>
<p>本文主要内容如下：</p>
<ol>
<li>剖析小黑瓜机中涉及的游戏机制</li>
<li>从理论角度分析影响小黑瓜机效率的因素</li>
<li>分析现有小黑瓜机的设计思路</li>
</ol>
<h2 id="一些术语"><a class="header-anchor" href="#一些术语"></a>一些术语</h2>
<h3 id="坐标"><a class="header-anchor" href="#坐标"></a>坐标</h3>
<p>在分析中，常用的坐标有两种：一种是由 3 个实数组成的<strong>点坐标</strong>，如 <code>(1.7, 2.5, 3.0)</code>，可以确定世界中的一个点；另一种则是由 3 个整数组成的<strong>方块坐标</strong>，如 <code>(1, 2, 3)</code>，可以确定世界中的一个方块位置</p>
<p>在本文中，当我们描述一个坐标 $P$ 时，我们可以用 $P.x$ 代表该坐标的 x 值，$P.y$ 代表该坐标的 y 值，$P.z$ 代表该坐标的 z 值</p>
<p>在 MC 中，我们可以将一个点坐标转换为方块坐标，方法也很简单——将点坐标的三个坐标值向<strong>下</strong>取整，得到三个整数，组合起来即为其所对应的方块坐标，即 $B = (\lfloor{A.x}\rfloor, \lfloor{A.y}\rfloor, \lfloor{A.z}\rfloor)$。这一坐标转换的几何意义也很明显：当点坐标 A 位于方块坐标 B 所代表的方块位置的 1x1x1 的立方体中时，点坐标 A 转换为的方块坐标即为 B，如下图所示：</p>
<p><img data-src="/zh-CN/2023/endermelon-notes/coord.png" alt="方块坐标"></p>
<p>本文将对这一 1x1x1 立方体称为方块坐标 B 对应的方格</p>
<p>对于实体而言，一个实体的<strong>实体坐标</strong>，指的是该实体碰撞箱下表面中心点所在的<strong>点坐标</strong>，这也是在召唤/传送的实体的时所使用的的坐标。对于玩家而言，玩家的实体坐标即为 F3 中显示的 XYZ 坐标</p>
<p>对于生物而言，其<strong>眼部坐标</strong>是一个通过如下方法计算出来的点坐标：x / z 为其实体坐标的 x / z，y 为其实体坐标的 y 加上其眼部高度。可以使用 F3 + B 开启碰撞箱显示来可视化地观察一个生物的眼部坐标，如下图所示，从生物的头附近延伸出去的那根蓝线的起点，即为这个生物的眼部坐标</p>
<img data-src="/zh-CN/2023/endermelon-notes/eyepos.png" alt="村民的眼部坐标" style="zoom:67%;">
<h3 id="AI"><a class="header-anchor" href="#AI"></a>AI</h3>
<p>本文将使用以下与 生物 AI 相关的术语：</p>
<ul>
<li>行为：生物 AI 中的基本行为单元，如“随机移动”、“观察玩家”、“搜索目标”等行为，在代码中对应的基类为 <code>EntityAIBase</code>（MCP）、<code>Goal</code>（yarn、mojmap）。对于小黑而言，则存在着“捡起方块”、“放置方块”等行为</li>
<li>两个生物之间存在视野接触：指的是两者的眼部坐标之间的连线不存在方块阻挡。这里的方块阻挡判断使用了采用方块的碰撞箱作为方块轮廓，忽略实体的射线检测</li>
</ul>
<h2 id="理论知识"><a class="header-anchor" href="#理论知识"></a>理论知识</h2>
<h3 id="末影人"><a class="header-anchor" href="#末影人"></a>末影人</h3>
<p>小黑高 2.9m，宽 0.6m，眼部高度 2.55，为末地中唯一可自然生成的怪物。小黑的刷出条件与普通怪物一致，每次成群刷出的最大数量为 4</p>
<h4 id="瞬移"><a class="header-anchor" href="#瞬移"></a>瞬移</h4>
<p>小黑会在以下事件发生时，进行瞬移尝试：</p>
<table>
<thead>
<tr>
<th>事件</th>
<th>概率</th>
<th>尝试次数</th>
<th>瞬移指向</th>
</tr>
</thead>
<tbody>
<tr>
<td>暴露在天空光下</td>
<td>与天空光亮度相关</td>
<td>1</td>
<td>随机</td>
</tr>
<tr>
<td>受到远程攻击伤害，如箭矢、三叉戟等</td>
<td>100%</td>
<td>64</td>
<td>随机</td>
</tr>
<tr>
<td>受到无视护甲的伤害，无论该伤害是否成功作用于小黑</td>
<td>90%</td>
<td>1</td>
<td>随机</td>
</tr>
<tr>
<td>正攻击玩家，距离玩家小于 4m，且玩家盯着小黑自己时</td>
<td>N/A</td>
<td>1</td>
<td>随机</td>
</tr>
<tr>
<td>正攻击玩家，距离玩家大于 16m，且离上次攻击玩家时的传送一段时间</td>
<td>N/A</td>
<td>1</td>
<td>目标玩家</td>
</tr>
</tbody>
</table>
<p>小黑的瞬移尝试并不一定会成功：如果瞬移目的地不合法，则本次尝试将失败，小黑留在原地</p>
<p>由于小黑瓜机总是处于末地维度，也不依赖玩家的仇恨，因此我们仅需要考虑上表中与伤害相关的两种瞬移，可以发现它们都属于随机瞬移，仅仅是瞬移的尝试次数以及概率有所不同</p>
<p>小黑的随机瞬移分为两步执行，第一步是选取目标瞬移坐标，第二步为对目标坐标进行调整得到最终瞬移坐标</p>
<p>选取目标坐标 vec 逻辑的逻辑如下所示：</p>
<ol>
<li>令 vec = 为小黑当前实体坐标</li>
<li>vec.x += [-32, 32] 范围内随机实数</li>
<li>vec.y += [-32, 32] 范围内随机整数</li>
<li>vec.z += [-32, 32] 范围内随机实数</li>
<li>尝试瞬移至坐标 vec</li>
</ol>
<p>根据上述逻辑，我们可以发现，小黑瞬移目标的范围近似为以小黑实体坐标为中心的一个 64x64x64 立方体。之所以说这是近似，是因为目的地 y 坐标的的可能取值是离散的，不能取到这一立方体中所有可能的 y 值</p>
<p>调整目标坐标 vec 得到最终瞬移目标的逻辑如下：</p>
<ol>
<li>令目标坐标为 vec</li>
<li>令目标坐标所处于的方块坐标为 pos</li>
<li>找到 pos 下方的最高的一个 pos’，使得 pos’ 下方方块的材料种类为 <a target="_blank" rel="noopener" href="https://joakimthorsen.github.io/MCPropertyEncyclopedia/?selection=variants,material_blocks_movement#">可阻挡移动</a> 的类型</li>
<li>如果 pos’ 不存在，传送失败，退出；否则继续执行</li>
<li>vec.y = vec.y - (pos.y - pos’.y + 1)</li>
<li>判断若小黑坐标设为 vec 后，其位置是否合法：小黑碰撞箱需要不与任意方块的碰撞箱重合，且碰撞箱中不能含有流体
<ul>
<li>如果位置合法，执行传送；否则传送失败</li>
</ul>
</li>
</ol>
<p>这部分逻辑也很移动，小黑并不想传送到半空中，在选定瞬移目标后会将其向下移动，找到一个“坚实”的落脚点，来作为最终的瞬移目的地。</p>
<p>从上述瞬移逻辑中我们可以看出，虽然小黑瞬移的目标坐标最多只能距离小黑 32m（切比雪夫距离），但是小黑传送的最终目的地是有可能下移至更低的位置。</p>
<img data-src="/zh-CN/2023/endermelon-notes/enderman-teleport.png" width="50%">
<h4 id="捡起方块"><a class="header-anchor" href="#捡起方块"></a>捡起方块</h4>
<p>小黑捡起方块的 AI 定义于名为 <code>EndermanEntity.PlaceBlockGoal</code> <sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> 的行为中。当这一行为被执行时，小黑将根据如下步骤选取并尝试捡起身边的一个方块：</p>
<ol>
<li>令小黑的实体坐标为 $A$，小黑将随机选取一个点 $B$，代表即将捡起的方块的位置，其中</li>
</ol>

\begin{align}
B.x &= A.x + [-2, 2] \mbox{间随机实数} \\
B.y &= A.y + [0, 3] \mbox{间随机实数} \\
B.z &= A.z + [-2, 2] \mbox{间随机实数}
\end{align}

<p>如果我们绘制一个长宽均为 4，高为 3 的长方体 $R$，并令该长方体下表面的中心点与 $A$ 重合，那么 $B$ 即可视作此 $R$ 中的一个随机点。长方体 $R$ 的示意图如下：</p>
<img data-src="/zh-CN/2023/endermelon-notes/pickup-target.png" alt="捡起方块选择范围" style="zoom:67%;">
<ol start="2">
<li>令 $B$ 对应的方块坐标为 $B’$，则本次捡方块行为将尝试捡起位于 $B’$ 的方块。</li>
<li>进行如下射线判断，判断小黑自己能不能<strong>捡得到</strong>这一目标方块：
<ol>
<li>令 $A’$ 为 $A$ 对应的方块坐标，也即小黑的实体坐标所对应的方块坐标。可以理解为小黑脚底位于的方块的坐标。</li>
<li>令 $P_{start} = (A’.x + 0.5, B’ + 0.5, A’.z + 0.5)$，即取用 $A’$ 的 xz，再取 $B’$ 的 y，构造出一个方块坐标 $P$，最后取 $P$ 所代表方格的中心点。</li>
<li>令 $P_{end} = (B’.x + 0.5, B’.y + 0.5, B’.z + 0.5)$，即取 $B’$ 对应方格的中心点。</li>
<li>从 $P_{start}$ 至 $P_{end}$ 进行一次射线判定，射线判断可以认为是从起点到终点连一条线，看看该连线有没有与方块相交（被方块阻挡）。如果这一射线判定被除了 $P_{end}$ 所在的方块以外的方块阻挡，则判断失败，小黑无法捡到这一方块；如果射线判定未被任何方块阻挡，或者阻挡的方块即为 $P_{end}$ 所在的方块，那么判断成功，小黑能见到这一方块。</li>
</ol>
</li>
</ol>
<p>这部分判断的逻辑较为复杂，可以参考下图的实例进行理解。在下图中，紫色的点代表 $A$，绿色的点代表 $B$，紫色的框代表 $P$，绿色的框代表 $B’$，紫框与绿框间的淡灰线段的两个端点分别为 $P_{start}$ 与 $P_{end}$，同时这一线段也对应着射线判定时所代表的连线。</p>
<img data-src="/zh-CN/2023/endermelon-notes/pick.gif" alt="pick" style="zoom: 67%;">
<p>现在小黑已经确定自己能捡得到这一个方块了，只剩下最后一步，判断自己能不能<strong>捡得起</strong>这一个方块:</p>
<ol start="4">
<li>判断目标方块是否带有 <code>enderman_holdable</code> 标签，若有则代表小黑能捡起这一方块；若无则小黑不能捡起这一方块，终止流程。注意，具有 <code>enderman_holdable</code> 标签的方块集合随着 MC 版本的变更有修改，如在 1.13 中所有的小型花并不具有这一标签。在 1.12 及以前，小黑能捡起方块集合是硬编码于代码中，而非由方块标签控制的</li>
<li>小黑把目标方块捡到手里，随后移除世界中的这个方块</li>
</ol>
<p>在理解了上述目标方块选取的逻辑后，我们可以得到一些性质：</p>
<ul>
<li>一个方块是被小黑选中的概率至于其相对于小黑的位置有关，与方块的形状/属性无关</li>
<li>一个方块所在方格与长方体 R 重合的越多，它被小黑选中的概率也越高。在该方块的方格完全处于 R 的内部时，它被小黑选中的概率达到最大值，为 $\frac{1}{4*4*3} = \frac{1}{48}$</li>
<li>射线判断起点与重点的 y 坐标相等，它们的连线平行于水平面</li>
</ul>
<p>既然谈到了射线检测，那我们也需要明确一下此处用小黑捡方块使用的射线检测的一些特点：</p>
<ul>
<li>忽略流体</li>
<li>仅考虑方块的边界框，也即指针指向时渲染的黑线框。方块的碰撞箱将被忽略</li>
<li>1.13 及以前，无碰撞箱的方块，如栅栏门，会被忽略</li>
</ul>
<p>在判断射线是否会与方块相交的时候，常常会遇到如下图所示的临界情况：</p>
<img data-src="/zh-CN/2023/endermelon-notes/edgecase.png" alt="临界情况" style="zoom:67%;">
<p>对于这种射线穿对角的临界情况，射线是否会被阻挡，在不同的 Minecraft 版本有着不同的答案，其结果甚至可能依赖于位置，因此难以总结出一个通用的规律。各位读者如果有需要，建议自行前往游戏中进行验证。下面是 1.13.2 和 1.15.2 版本中，射线可穿对角情况的示意图
<img data-src="/zh-CN/2023/endermelon-notes/raycast-corner.png" alt="射线穿对角临界情况"></p>
<p>本章节剩余部分以 Minecraft 1.13.2 为例，讨论方块距离小黑切比雪夫距离为 1 的情况。虽然这一规律并不适用于 1.14+ 的版本，但与其的思想是相同的</p>
<p>直接上结论：在 1.13.2 中，仅在射线在 x 轴方向投影指向 x 轴负半轴时，也即朝西，射线会与这两个方块相交，此时这两个方块之间任意一个都能阻拦射线；反之，若射线在 x 轴上的投影指向 x 轴正半轴，也即朝东，则射线将忽略这两个方块，此时这两个方块都无法阻拦射线。如下图所示：</p>
<img data-src="/zh-CN/2023/endermelon-notes/edgecase-explaination.png" alt="临界情况性质" style="zoom:67%;">
<p>可以感性的理解这一特性：当且仅当射线朝向 x 正半轴时不会被方块阻拦。本文称上述方向依赖性的射线逻辑为“东向穿缝性”。这一个性质在设计小黑瓜机中的瓜布局时非常重要，对这一性质的充分利用可以有效地提升西瓜的密度，同时这也是不少小黑瓜机，如 <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1YK4y1d7jD/">dugged 服务器的瓜机</a>，依赖于朝向的原因之一</p>
<p>上述这一射线传对角缝的性质，是我们在设计小黑瓜机中的瓜布局时需要常记于心的。同时这一性质也是不少小黑瓜机依赖于朝向的原因之一</p>
<p>本章节所使用的，用于展示末影人捡起方块射线端点逻辑的 scarpet 指令（在 fabric-carpet v1.4.8、v1.4.91 中测试可用）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/execute <span class="keyword">as</span> @e[<span class="built_in">type</span>=minecraft:enderman,distance=.<span class="number">.16</span>] run script run </span><br><span class="line">t=<span class="number">20</span>;[x,y,z]=pos(p);</span><br><span class="line">draw_shape(<span class="string">&#x27;box&#x27;</span>,<span class="number">2</span>,[<span class="string">&#x27;from&#x27;</span>,[x-<span class="number">2</span>,y,z-<span class="number">2</span>],<span class="string">&#x27;to&#x27;</span>,[x+<span class="number">2</span>,y+<span class="number">3</span>,z+<span class="number">2</span>],<span class="string">&#x27;color&#x27;</span>,<span class="number">0x2255AA88</span>]);</span><br><span class="line">draw_shape(<span class="string">&#x27;sphere&#x27;</span>,<span class="number">2</span>,[<span class="string">&#x27;center&#x27;</span>,[x,y,z],<span class="string">&#x27;radius&#x27;</span>,<span class="number">0.02</span>,<span class="string">&#x27;color&#x27;</span>,<span class="number">0xDD00DD88</span>]);</span><br><span class="line"><span class="keyword">if</span>(world_time()%t==<span class="number">0</span>,</span><br><span class="line">  [x1,y1,z1]=[x-<span class="number">2</span>+rand(<span class="number">4</span>),y+rand(<span class="number">3</span>),z-<span class="number">2</span>+rand(<span class="number">4</span>)];</span><br><span class="line">  <span class="keyword">from</span>=[floor(x)+<span class="number">0.5</span>,floor(y1)+<span class="number">0.5</span>,floor(z)+<span class="number">0.5</span>];</span><br><span class="line">  to=[floor(x1)+<span class="number">0.5</span>,floor(y1)+<span class="number">0.5</span>,floor(z1)+<span class="number">0.5</span>];</span><br><span class="line">  draw_shape(<span class="string">&#x27;box&#x27;</span>,t,[<span class="string">&#x27;from&#x27;</span>,<span class="keyword">from</span>-[<span class="number">0.5</span>,<span class="number">0.5</span>,<span class="number">0.5</span>],<span class="string">&#x27;to&#x27;</span>,<span class="keyword">from</span>+[<span class="number">0.5</span>,<span class="number">0.5</span>,<span class="number">0.5</span>],<span class="string">&#x27;color&#x27;</span>,<span class="number">0xFF33FFFF</span>]);</span><br><span class="line">  draw_shape(<span class="string">&#x27;box&#x27;</span>,t,[<span class="string">&#x27;from&#x27;</span>,to-[<span class="number">0.5</span>,<span class="number">0.5</span>,<span class="number">0.5</span>],<span class="string">&#x27;to&#x27;</span>,to+[<span class="number">0.5</span>,<span class="number">0.5</span>,<span class="number">0.5</span>],<span class="string">&#x27;color&#x27;</span>,<span class="number">0x00DD00DD</span>]);</span><br><span class="line">  draw_shape(<span class="string">&#x27;line&#x27;</span>,t,[<span class="string">&#x27;from&#x27;</span>,<span class="keyword">from</span>,<span class="string">&#x27;to&#x27;</span>,to,<span class="string">&#x27;line&#x27;</span>,<span class="number">3</span>,<span class="string">&#x27;color&#x27;</span>,<span class="number">0xDDDDDDFF</span>]);</span><br><span class="line">  draw_shape(<span class="string">&#x27;sphere&#x27;</span>,t,[<span class="string">&#x27;center&#x27;</span>,[x1,y1,z1],<span class="string">&#x27;radius&#x27;</span>,<span class="number">0.02</span>,<span class="string">&#x27;color&#x27;</span>,<span class="number">0x77FF77FF</span>]);</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="放置方块"><a class="header-anchor" href="#放置方块"></a>放置方块</h4>
<p>小黑放置方块的 AI 定义于名为 <code>EndermanEntity.PlaceBlockGoal</code> <sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> 的行为中。当这一行为被执行时，小黑将根据如下步骤选取并尝试放置时其所持有的方块：</p>
<ol>
<li>令小黑的实体坐标为 $A$，小黑将随机选取一个点 $B$，代表即将放置的方块的位置，其中</li>
</ol>

\begin{align}
B.x &= A.x + [-1, 1] \mbox{间随机实数} \\
B.y &= A.y + [0, 2] \mbox{间随机实数} \\
B.z &= A.z + [-1, 1] \mbox{间随机实数}
\end{align}

<p>类似捡起方块的流程，如果我们绘制一个边长为 2 的立方体 $C$，并令该立方体下表面的中心点与 $A$ 重合，那么 $B$ 即可视作此 $C$ 中的一个随机点。立方体 $C$ 的示意图如下：</p>
<img data-src="/zh-CN/2023/endermelon-notes/placedown-target.png" alt="放下方块选择范围" style="zoom: 67%;">
<ol start="2">
<li>令 $B$ 对应的方块坐标为 $B’$，则本次放置方块行为将尝试将方块放至 $B’$ 处</li>
<li>判断此次方块放置是否合法。一次合法的方块放置需要满足以下条件：
<ol>
<li>$B’$ 处的方块为空气</li>
<li>$B’$ 下方的方块不是空气，且为一个碰撞箱是完整的 1x1x1 方块</li>
<li>$B’$ 所在环境对于小黑手持的方块而言，是一个合法的状态。如若小黑手持花方块，则 $B’$ 必须位于泥土类方块的上方</li>
<li>（1.16.2-pre1 及以后）$B’$ 下方的方块不是基岩</li>
<li>（1.16.2-pre2 及以后）$B’$ 所对应的方格范围，不与任何除了这只小黑外的实体的碰撞箱相交</li>
</ol>
</li>
<li>执行方块放置，将小黑手持的方块放置于 $B’$ 处</li>
</ol>
<p>下面是一个具体的例子，其中：</p>
<ul>
<li>紫点为点坐标 $A$</li>
<li>蓝框为立方体 $C$</li>
<li>绿点为点坐标 $B$</li>
<li>绿框为方块坐标 $B’$ 所处的方格</li>
</ul>
<img data-src="/zh-CN/2023/endermelon-notes/placedown-underneath.png" style="zoom:67%;">
<p>小黑准备把手持的西瓜方块放置于绿框处，进行放置检查，发现 $B’$ 下方的方块是平滑石上半砖，不是一个碰撞箱完整的方块，因此这次方块放置的尝试失败</p>
<p>在设计小黑瓜机时，大部分情况下我们需要阻止小黑随处放置手里的西瓜。对此，一些常用的手段有：</p>
<ul>
<li>将所有小黑可触及的位置都放上方块，火把按钮什么的均可，因为小黑只能在空气方块位置放置方块</li>
<li>确保不存在空气方块+碰撞箱完整方块的组合，例如用上半砖来替代实体方块来作为上表面完整的方块</li>
</ul>
<p><img data-src="/zh-CN/2023/endermelon-notes/placement-proof.png" alt="如何阻止末影人乱放方块"></p>
<p>本章节所使用的，用于展示末影人放下方块逻辑的 scarpet 指令（在 fabric-carpet v1.4.8、v1.4.91 中测试可用）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/execute <span class="keyword">as</span> @e[<span class="built_in">type</span>=minecraft:enderman,distance=.<span class="number">.16</span>] run script run </span><br><span class="line">t=<span class="number">20</span>;[x,y,z]=pos(p);</span><br><span class="line">draw_shape(<span class="string">&#x27;box&#x27;</span>,<span class="number">2</span>,[<span class="string">&#x27;from&#x27;</span>,[x-<span class="number">1</span>,y,z-<span class="number">1</span>],<span class="string">&#x27;to&#x27;</span>,[x+<span class="number">1</span>,y+<span class="number">2</span>,z+<span class="number">1</span>],<span class="string">&#x27;color&#x27;</span>,<span class="number">0x2255AA88</span>,<span class="string">&#x27;line&#x27;</span>,<span class="number">4</span>]);</span><br><span class="line">draw_shape(<span class="string">&#x27;sphere&#x27;</span>,<span class="number">2</span>,[<span class="string">&#x27;center&#x27;</span>,[x,y,z],<span class="string">&#x27;radius&#x27;</span>,<span class="number">0.02</span>,<span class="string">&#x27;color&#x27;</span>,<span class="number">0xDD00DD88</span>]);</span><br><span class="line"><span class="keyword">if</span>(world_time()%t==<span class="number">0</span>,</span><br><span class="line">  [x1,y1,z1]=[x-<span class="number">1</span>+rand(<span class="number">2</span>),y+rand(<span class="number">2</span>),z-<span class="number">1</span>+rand(<span class="number">2</span>)];</span><br><span class="line">  pos=[floor(x1),floor(y1),floor(z1)];</span><br><span class="line">  draw_shape(<span class="string">&#x27;box&#x27;</span>,t,[<span class="string">&#x27;from&#x27;</span>,pos,<span class="string">&#x27;to&#x27;</span>,pos+[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],<span class="string">&#x27;color&#x27;</span>,<span class="number">0x00DD00DD</span>,<span class="string">&#x27;line&#x27;</span>,<span class="number">4</span>]);</span><br><span class="line">  draw_shape(<span class="string">&#x27;sphere&#x27;</span>,t,[<span class="string">&#x27;center&#x27;</span>,[x1,y1,z1],<span class="string">&#x27;radius&#x27;</span>,<span class="number">0.02</span>,<span class="string">&#x27;color&#x27;</span>,<span class="number">0x77FF77FF</span>]);</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="仇恨"><a class="header-anchor" href="#仇恨"></a>仇恨</h4>
<p>小黑对玩家生成的末影螨有着天然的仇恨，会主动移动至搜索范围内 <a href="#AI">视野可见</a> 的末影螨处并对其进行攻击。与之对应的行为为 <code>FollowTargetGoal</code> <sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>，这一 goal 对目标实体的搜索范围为小黑的碰撞箱水平四方向扩展 <code>generic.followRange</code> 米，这里的 <code>generic.followRange</code> 为生物共有的一个属性，是在其生成时确定的一个定值。对于小黑而言，其计算算法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 22w16a（1.19快照）及以后</span></span><br><span class="line">generic.followRange = <span class="number">64</span> * (<span class="number">1</span> + nextGaussian() * <span class="number">0.05</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 22w16a（1.19快照）以前</span></span><br><span class="line">generic.followRange = <span class="number">64</span> * (<span class="number">1</span> + nextTriangular(<span class="number">0</span>, <span class="number">0.11485</span>))</span><br></pre></td></tr></table></figure>
<p>其中：</p>
<ul>
<li><code>nextGaussian()</code> 返回一个标准正态分布随机数</li>
<li><code>nextTriangular(0, 0.11485)</code> 返回一个范围为 [-0.11485, 0.11485] 的三角分布随机数</li>
</ul>
<p>下面的图表展示了 <code>generic.followRange</code> 的概率分布</p>
<table>
<thead>
<tr>
<th>≤ n 的概率</th>
<th>22w16a 以前</th>
<th>22w16a 及以后</th>
</tr>
</thead>
<tbody>
<tr>
<td>64</td>
<td>50%</td>
<td>50%</td>
</tr>
<tr>
<td>62</td>
<td>26.60%</td>
<td>26.49%</td>
</tr>
<tr>
<td>60</td>
<td>10.57%</td>
<td>10.39%</td>
</tr>
<tr>
<td>58</td>
<td>3.04%</td>
<td>1.69%</td>
</tr>
<tr>
<td>56</td>
<td>0.62%</td>
<td>0%</td>
</tr>
<tr>
<td>52</td>
<td>0.0088%</td>
<td>0%</td>
</tr>
<tr>
<td>48</td>
<td>2.87E-7</td>
<td>0%</td>
</tr>
</tbody>
</table>
<p><img data-src="/zh-CN/2023/endermelon-notes/followRange-distribution.png" alt="generic.followRange 的概率分布图"></p>
<p>由此可见：</p>
<ul>
<li>22w16a 以前，由于涉及无上下界的正态分布，<code>generic.followRange</code> 的值可能会非常大，也有可能会非常小。这也是使用末影螨作为仇恨源的小黑瓜机总是时不时会有一些眼瞎小黑一直获取不到末影螨仇恨的原因——无界正态分布总有概率能让小黑的仇恨范围 <code>generic.followRange</code> 变成一个特别小的值</li>
<li>22w16a 及以后，使用了有界的三角分布，因此 <code>generic.followRange</code> 不再可能取到过大或过小的值，其可能的取值范围约为 [56.65, 71.35]</li>
</ul>
<h3 id="生物-AI"><a class="header-anchor" href="#生物-AI"></a>生物 AI</h3>
<p>生物的行为大多由其 AI 控制，末影人也不例外，如上文 <a href="#%E6%9C%AB%E5%BD%B1%E4%BA%BA">末影人</a> 章节中 <a href="#%E6%8D%A1%E8%B5%B7%E6%96%B9%E5%9D%97">捡起方块</a>、<a href="#%E6%94%BE%E4%B8%8B%E6%96%B9%E5%9D%97">放下方块</a> 这两个行为即是由 AI 控制的</p>
<p>对于设计小黑瓜机而言，我们关注的生物 AI 如何控制 <a href="#AI">行为</a> 的执行，行为执行频繁会是怎样：是每 gt 都执行，还是每隔几个 gt 才执行；每次执行时是一定执行，还是有概率执行。毕竟，小黑“捡起方块”行为的执行频率，直接影响了小黑捡瓜的概率。</p>
<p>对于这部分的机制 &lt;=1.13 跟 &gt;=1.14 这两个版本范围间存在着不小的差异，具体分析如下：</p>
<p>1.13 及以前：</p>
<ul>
<li>每 3gt 将与执行中的目标不冲突，且可以开始的新目标，添加进执行列表</li>
<li>每 1gt 清理执行列表中的目标，将不可继续的目标移出执行列表</li>
<li>每 1gt 遍历并执行执行列表中的目标</li>
</ul>
<p>1.14 及以后：</p>
<ul>
<li>每 1gt 停止不可继续执行的目标，并将它们移出执行列表</li>
<li>每 1gt 将与执行中的目标不冲突且可以开始的新目标，添加进执行列表</li>
<li>每 1gt 遍历并执行执行列表中的目标</li>
</ul>
<p>其中：</p>
<ul>
<li>目标可以开始，指的是其 <code>Goal#canStart</code> <sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> 函数返回结果为 true</li>
<li>目标不可继续，指的是其 <code>Goal#shouldContinue</code> <sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup> 函数返回值为 false</li>
<li>目标之间不冲突，指的是目标之间对生物的 控制类型 <sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> 的集合交集为空。一个目标可以占用生物若干个控制类型，包括移动、视野、跳跃以及索敌这四种</li>
</ul>
<p>对于小黑“捡起方块”这个目标而言：</p>
<ul>
<li>只有 $1 / 20$ 的概率可以开始，因为 <code>PickUpBlockGoal#canStart</code> 这个函数仅有 $1 / 20$ 的概率返回 true</li>
<li>可以继续的概率与可以开始的概率相同</li>
<li>不占用任何控制类型</li>
</ul>
<p>可以发现，1.14 及以后的行为执行频率模型非常简易，可以直接视为每个行为每 gt 只要可以开始，那就可以执行。因此，对于小黑“捡起方块”这个目标而言，每个 gt 执行的概率都相同，等于其可开始概率 $1 / 20$</p>
<p>不过，1.13 及以前的行为执行频率模型就复杂不少了，虽然都是每 gt 都会清理 &amp; 执行目标，但添加新的目标是每 3gt 才执行一次。目标添加进执行列表后，每个 gt 都得判断它是否还能继续，这会导致小黑“捡起方块”这种概率性可继续执行的目标，执行概率指数下跌</p>
<p>如果以 3gt 为周期，那么对于小黑“捡起方块”这个目标而言，有</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>执行概率</th>
</tr>
</thead>
<tbody>
<tr>
<td>gt0</td>
<td>$(1 / 20) = 0.05$</td>
</tr>
<tr>
<td>gt1</td>
<td>$(1 / 20) * (1 / 20) ^ 1 = 2.5 * 10 ^{-3}$</td>
</tr>
<tr>
<td>gt2</td>
<td>$(1 / 20) * (1 / 20) ^ 2 = 1.25 * 10 ^{-4}$</td>
</tr>
<tr>
<td>平均值</td>
<td>$0.01754$，约 $1/57$</td>
</tr>
</tbody>
</table>
<p>是的，在 1.13-，小黑每 gt 执行“捡起方块”目标的概率仅有 $1 / 57$，与 1.14+ 的 $1 / 20$ 相比有着明显的差距，大概仅为 1.14+ 概率的 $1 / 3$。执行“捡起方块”目标并尝试捡瓜的执行概率直接影响了小黑捡起西瓜的成功率，这就是 1.13- 和 1.14+ 之间小黑瓜机概率差距大的原因之一</p>
<h3 id="瓜苗"><a class="header-anchor" href="#瓜苗"></a>瓜苗</h3>
<p>西瓜苗跟南瓜苗一样，共用着 <code>StemBlock</code> <sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> 这个类，拥有着相同的生长逻辑。下文使用瓜苗一词来指代西瓜苗及南瓜苗</p>
<p>跟其他农作物一样，瓜苗的生长速度取决于其附近湿润耕地的数量，以及附近同种作物的数量。不防令其生长速度为 $s$，$s$ 越大则生长速度越快，那么对于瓜苗，我们可以通过如下流程计算出 $s$：</p>
<ol>
<li>
<p>令 $s$ 为初值 $1$</p>
</li>
<li>
<p>统计瓜苗附近耕地的湿润值。统计瓜苗下方一格，水平方向切比雪夫距离 &lt;= 1 的耕地。对于瓜苗正下方的耕地，若为湿润，则 $s$ 增加 $3$；若为干燥，则 $s$ 增加 $1$。对于范围内其余耕地，若为湿润，则 $s$ 增加 $0.75$。如下图左半边所示</p>
<p>其中，耕地为湿润 / 干燥是由其方块状态 <code>moisture</code> 决定的，<code>moisture</code> 为 0 时耕地干燥，<code>moisture</code> 大于 0 时耕地湿润</p>
</li>
<li>
<p>统计瓜苗附近的同种作物。当以下条件任意一者满足时，将 $s$ 值除以 $2$</p>
<ul>
<li>瓜苗的南方或北方的作物（下图右侧粉圈）为同种作物，且瓜苗的东方或西方的作物（下图右侧蓝圈）为同种作物</li>
<li>瓜苗的西北、东北、东南、西南处其中之一（下图右侧黄圈）的作物是同种作物</li>
</ul>
<p>其中，同种作物指的是方块类型相同的作物，比如西瓜苗跟南瓜苗不是同种作物，西瓜苗跟土豆也不是同种作物，但生长长度 <code>age</code> 不同的西瓜苗之间是同种作物</p>
<p>值得一提，在 1.13 及以后，麻将把生长中的瓜苗和长了瓜的瓜苗拆分成了 2 个不同的方块类型，这导致西瓜苗（<code>minecraft:melon_stem</code>）和长了瓜的瓜苗（<code>minecraft:attached_melon_stem</code>）不再是同种作物，南瓜同理</p>
</li>
<li>
<p>生长速度 $s$ 计算完毕</p>
</li>
</ol>
<p><img data-src="/zh-CN/2023/endermelon-notes/crop-grow-speed.png" alt="生长速度计算流程"></p>
<p>可以这样感性地理解生长速度的计算流程：周围湿润的耕地越多，营养就越多，生长速度就越快；附近的同种作物会争抢营养，导致生长速度下降</p>
<p>同其他作物一样，触发瓜苗生长的事件是随机刻。在瓜苗方块受到随机刻作用时，如果其光照条件满足要求，那么将会有 $\frac{1}{n}$ 的概率进行一次生长。其中：</p>
<ul>
<li>光照条件要求：
<ul>
<li>1.12：瓜苗上方一格方块的亮度等级 &gt;= 9。此处亮度计算包含天空光，考虑天空光衰减</li>
<li>1.13：瓜苗上方一格方块的亮度等级 &gt;= 9。此处亮度计算包含天空光，不考虑天空光衰减</li>
<li>1.14+：瓜苗处的亮度等级 &gt;= 9。此处亮度计算包含天空光，不考虑天空光衰减</li>
</ul>
</li>
<li>$n = \left\lfloor{\frac{25}{s}}\right\rfloor + 1$，其中 $s$ 即为上文描述的生长速度</li>
</ul>
<p>瓜苗进行生长时，首先会看看它的方块状态 <code>age</code> 值是否达到了最大值 7，若未达到，则将其 <code>age</code> 值 +1，生长结束；若 <code>age</code> 已达 7，瓜苗会随机挑选一个水平毗邻的方块坐标，尝试在次数结瓜。结瓜需要满足以下条件：</p>
<ul>
<li>结瓜处为空气。瓜只能长在空气里，不能挤掉已存在的方块</li>
<li>结瓜处下方一格为泥土类型方块，包括耕地、泥土、砂土、灰化土、草方块这一类等含有 <code>dirt</code> 方块标签的方块</li>
</ul>
<p>条件满足，那么瓜苗将进行结瓜，放置瓜苗方块、长了瓜的瓜苗方块；条件不满足，那么结瓜尝试失败，不会进行重试</p>
<p>至此，瓜苗的生长流程分析完毕。下面是一个具体的例子以供参考</p>
<p><img data-src="/zh-CN/2023/endermelon-notes/crop-grow-speed-example.png" alt="生长速度计算例子"></p>
<p>上图所示的瓜苗布局中，中心瓜苗的生长速度 $s$ 以及生长概率 $\frac{1}{n}$ 的计算流程如下</p>
<ol>
<li>$s$ 赋初值 $1$</li>
<li>统计瓜苗附近耕地的湿润值，$s$ 共增加 $7$，为 $8$</li>
<li>计瓜苗附近的同种作物，$s$ 折半，为 $4$</li>
<li>$n = \left\lfloor{\frac{25}{s}}\right\rfloor + 1 = \left\lfloor{\frac{25}{4}}\right\rfloor + 1 = 6 + 1 = 7$</li>
</ol>
<p>因此，中心瓜苗在每接受一次随机刻时，有 $1/7$ 的概率进行生长。由于其已达到最大 <code>age</code> 值，因此每次生长都将尝试长瓜。</p>
<p>考虑到中心瓜苗水平毗邻的 4 个位置只有 2 个位置为空气，因此尝试长瓜时，还需 2 / 4 的概率才能长出瓜来</p>
<p>令中心瓜苗每接受一次随机刻时的长出瓜的概率为 $p$，则 $p = \frac{1}{n} * \frac{2}{4} = \frac{1}{14}$</p>
<h2 id="呱唧分析"><a class="header-anchor" href="#呱唧分析"></a>呱唧分析</h2>
<h3 id="农场结构"><a class="header-anchor" href="#农场结构"></a>农场结构</h3>
<p>无论呱唧的结构，</p>
<p>无论采取怎样的呱唧设计思路，瓜机的结构都可以分为以下 3 个部分：</p>
<ol>
<li>刷怪单元</li>
<li>捡瓜通道</li>
<li>处死模块</li>
</ol>
<p><img data-src="/zh-CN/2023/endermelon-notes/farm-architecture.png" alt="农场结构"></p>
<p>我们称一个包含上述 3 个部分的最小可运行结构，为产瓜单元。通常来说，一个产瓜单元的独立性是比较强的</p>
<h3 id="前提假设"><a class="header-anchor" href="#前提假设"></a>前提假设</h3>
<p>下文对小黑瓜机分析的重点是，瓜机的效率上限计算，并以提升瓜机效率的最大值为设计目标。不妨作出下述的前提假设：</p>
<ul>
<li>
<p>刷怪上限有限。通常而言，这个上限值为 70，对应着单玩家所能提供的刷怪上限</p>
</li>
<li>
<p>瓜机的规模足够大。本文分析的小黑瓜机设计均由多个独立的产瓜单元组成，产瓜单元之间耦合度很低，可以直接通过堆叠产瓜单元的手段来增加瓜机效率</p>
<p>虽说一味地增加瓜机体积的收益是边际递减的，但在单元数量堆叠到一定程度时，其余条件就已经很接近理想情况了</p>
</li>
<li>
<p>刷怪满上限。瓜机的规模足够大意味着刷怪面积是充足的，那么每当小黑数量降至怪物容量内时，新的小黑会很快地刷出来，继续顶满刷怪上限</p>
<ul>
<li>这意味着同时存在小黑数量的期望值等于怪物容量，即在每时每刻都存在约 70 只小黑</li>
<li>在实际情况中，考虑到过量生成的情况，同时存在的小黑数量有可能超过怪物容量</li>
</ul>
</li>
<li>
<p>瓜田接近满瓜。考虑到同时存在的小黑数量是有限的，在瓜机规模足够大时，每个产瓜单元分到的小黑流量是很低的，这会导致瓜苗长瓜的速度明显高于小黑搬瓜的速度，进而导致瓜田是处于一个接近满瓜的状态</p>
</li>
</ul>
<p>若无特殊说明，下文的分析均以上述假设为背景进行</p>
<h3 id="理论效率计算"><a class="header-anchor" href="#理论效率计算"></a>理论效率计算</h3>
<p>核心公式：</p>
<ul>
<li>瓜机产率(瓜/h) = 小黑刷怪速率(只/h) * 小黑捡瓜率(瓜/只)</li>
</ul>
<p>刷怪公式：</p>
<p>[—][—][—][—][—][—]
[—][—][—][—][—][—]
[—][—][—][—][—][—]
[—][—][—][—][—][—]
[------------ 1h -----------]</p>
<ul>
<li>小黑刷怪速率(只/h)，即每小时小黑生成数量(只) / 1 小时(h)</li>
<li>= 平均同时存在的小黑数(只) / 小黑平均存活时间(h)</li>
<li>= 平均同时存在的小黑数(只) / 小黑平均存活时间(h)</li>
<li>=</li>
<li>= 平均同时存在的小黑数(只) * 每小时游戏刻数(gt/h) / 小黑平均存活时间(gt)</li>
<li>= (72000 * 70) / 平均存活时间</li>
</ul>

\begin{align}
小黑刷怪速率 &= 每小时小黑生成数量 / 1小时 \
&= 1 小时小黑生成数量 / 1小时 \
&= 平均小黑数量 * 
&= 每小时的游戏刻数 / 存活时间 * 70
&= 72000 / 存活时间 * 70
\end{align}

<p>其中存活时间以 gt 作为单位</p>
<p>捡瓜率：</p>
<h3 id="瓜密度"><a class="header-anchor" href="#瓜密度"></a>瓜密度</h3>
<p>小黑捡方块范围内有效瓜的总体积占比</p>
<h4 id="冲突瓜"><a class="header-anchor" href="#冲突瓜"></a>冲突瓜</h4>
<p>小红文</p>
<h2 id="设计思路"><a class="header-anchor" href="#设计思路"></a>设计思路</h2>
<h3 id="基于末影螨仇恨的瓜机"><a class="header-anchor" href="#基于末影螨仇恨的瓜机"></a>基于末影螨仇恨的瓜机</h3>
<p>使用末影螨吸引小黑最大的优点为，可以在主体结构不变的情况下轻易地增加大量刷怪面积。</p>
<p>缺点：小黑发现末影螨需要时间</p>
<p>总结：性价比高，上限低。</p>
<h4 id="刷怪单元"><a class="header-anchor" href="#刷怪单元"></a>刷怪单元</h4>
<h4 id="捡瓜通道"><a class="header-anchor" href="#捡瓜通道"></a>捡瓜通道</h4>
<h4 id="处死模块"><a class="header-anchor" href="#处死模块"></a>处死模块</h4>
<h3 id="基于机械结构的瓜机"><a class="header-anchor" href="#基于机械结构的瓜机"></a>基于机械结构的瓜机</h3>
<h4 id="刷怪单元-2"><a class="header-anchor" href="#刷怪单元-2"></a>刷怪单元</h4>
<h4 id="捡瓜通道-2"><a class="header-anchor" href="#捡瓜通道-2"></a>捡瓜通道</h4>
<h4 id="处死模块-2"><a class="header-anchor" href="#处死模块-2"></a>处死模块</h4>
<h2 id="总结"><a class="header-anchor" href="#总结"></a>总结</h2>
<h2 id="参考"><a class="header-anchor" href="#参考"></a>参考</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><code>EntityEnderman.AITakeBlock</code>（MCP）；<code>EnderMan.EndermanTakeBlockGoal</code>（mojmap） <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p><code>EntityEnderman.AIPlaceBlock</code>（MCP）；<code>EnderMan.EndermanLeaveBlockGoal</code>（mojmap） <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn3" class="footnote-item"><p><code>EntityAINearestAttackableTarget</code>（MCP）；<code>NearestAttackableTargetGoal</code>（mojmap） <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn4" class="footnote-item"><p><code>EntityAIBase#shouldExecute</code>（MCP）；<code>Goal#canUse</code> (mojmap) <a href="#fnref4" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn5" class="footnote-item"><p><code>EntityAIBase#shouldContinueExecuting</code>（MCP）；<code>Goal#canContinueToUse</code> (mojmap) <a href="#fnref5" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn6" class="footnote-item"><p>见函数 <code>EntityAIBase#getMutexBits</code>（MCP）；枚举类 <code>Goal.Control</code>（yarn）；枚举类 <code>Goal.Flag</code>（mojmap） <a href="#fnref6" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn7" class="footnote-item"><p><code>BlockStem</code>（MCP）；<code>StemBlock</code>（mojmap） <a href="#fnref7" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Fallen_Breath
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/" title="末影人西瓜农场笔记">https://blog.fallenbreath.me/zh-CN/2023/endermelon-notes/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Minecraft/" rel="tag"># Minecraft</a>
              <a href="/tags/%E6%9C%AB%E5%BD%B1%E4%BA%BA/" rel="tag"># 末影人</a>
              <a href="/tags/%E5%88%B7%E6%80%AA/" rel="tag"># 刷怪</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/zh-CN/2022/wiske-abused-notes/" rel="prev" title="Wiske Abused 笔记">
                  <i class="fa fa-angle-left"></i> Wiske Abused 笔记
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/zh-CN/2023/pve8-change-sourceslist/" rel="next" title="Proxmox VE 8 换源">
                  Proxmox VE 8 换源 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
  <div class="languages">
    <label class="lang-select-label">
      <i class="fa fa-language"></i>
      <span>简体中文</span>
      <i class="fa fa-angle-up" aria-hidden="true"></i>
    </label>
    <select class="lang-select" data-canonical="" aria-label="选择语言">
      
        <option value="zh-CN" data-href="/2023/endermelon-notes/" selected="">
          简体中文
        </option>
      
        <option value="en" data-href="/en/2023/endermelon-notes/" selected="">
          English
        </option>
      
    </select>
  </div>

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Fallen_Breath</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">83k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">2:30</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/Fallen-Breath" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"Fallen-Breath","repo":"blog-comments","client_id":"cf0173681bce1acd6dec","client_secret":"12c622fd7d1517f2a7973df89f8189c42dd9bf06","admin_user":"Fallen-Breath","distraction_free_mode":false,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"c168eb87016ae0d4ffd8f42491bbe80e"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
